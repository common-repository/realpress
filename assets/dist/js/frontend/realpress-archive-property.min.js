(()=>{"use strict";const e=window.wp.url,t=t=>(0,e.addQueryArgs)(document.location.origin+document.location.pathname,t),r=document.querySelector(".realpress-archive-property"),a=r.querySelector(".realpress-archive-property-content"),o=r.querySelector(".realpress-sort-by select"),s=r.querySelector(".realpress-property-container"),c=r.querySelector(".realpress-advanced-search"),i=REALPRESS_GLOBAL_OBJECT.rest_namespace||"";let n={offset:1,orderby:"date",order:"DESC",template:"archive_page"};const l=function(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s.style.opacity=.4,wp.apiFetch({path:(0,e.addQueryArgs)("/"+i+"/property-list",o),method:"GET"}).then((e=>{void 0!==e.data.content?s.innerHTML=e.data.content:e.msg&&(s.innerHTML=e.msg),void 0!==e.data.pagination?r.querySelector(".realpress-archive-property-pagination").innerHTML=e.data.pagination:r.querySelector(".realpress-archive-property-pagination").innerHTML="",void 0!==e.data.from_to?r.querySelector(".realpress-archive-property-from-to").innerHTML=e.data.from_to:r.querySelector(".realpress-archive-property-from-to").innerHTML="";const t=r.querySelector(".realpress-pagination");if(t){const e=t.querySelectorAll("a");for(let t=0;t<e.length;t++)e[t].addEventListener("click",(function(e){e.preventDefault();const t=this.getAttribute("data-page");o={...o,offset:t},l(o),a.scrollIntoView({behavior:"smooth"})}))}})).catch((e=>{console.log(e)})).finally((()=>{const e=t(o);window.history.pushState("","",e),s.style.opacity=1}))},p=()=>{const{taxonomy:e=""}=REALPRESS_PROPERTY_ARCHIVE_OBJECT,t=REALPRESS_PROPERTY_ARCHIVE_OBJECT.term_id||"";t&&e&&(n={...n,term_id:t,taxonomy:e});const s=(()=>{const e=new URLSearchParams(location.search),t={};for(const[r,a]of e)t[r]=a;return t})();Object.keys(s).length&&(n={...n,...s}),o.addEventListener("change",(function(e){const t=r.querySelector(".realpress-archive-property-pagination .realpress-pagination");let o=1;t&&(o=t.querySelector("li.current a").getAttribute("data-page"));const s=(e=>{let t,r;switch(e){case"default":default:t="date",r="DESC";break;case"name_asc":t="title",r="ASC";break;case"name_desc":t="title",r="DESC";break;case"price_desc":t="price",r="DESC";break;case"price_asc":t="price",r="ASC";break;case"rating_desc":t="rating",r="DESC";break;case"rating_asc":t="rating",r="ASC"}return{orderby:t,order:r}})(e.target.value);n={...n,...s,offset:o},l(n),a.scrollIntoView({behavior:"smooth"})})),c&&c.querySelector("button.realpress-search-property-button").addEventListener("click",(function(){const e=c.querySelectorAll(".realpress-search-field input,select");if(e){for(let t=0;t<e.length;t++){const r=e[t],a=r.getAttribute("name");""===r.value?n.hasOwnProperty(a)&&delete n[a]:n[a]=r.value}n={...n,offset:1},l(n),a.scrollIntoView({behavior:"smooth"})}})),l(n)};let d,u,y;const h=()=>{for(let e=0;e<u.length;e++)u[e].addEventListener("click",(function(){const e=d.querySelector(".realpress-item-switch-view li.active"),t=e.getAttribute("class");if(this.getAttribute("class")!==t){e.classList.remove("active"),this.classList.add("active");const t=this.getAttribute("data-grid-col");y.setAttribute("data-grid-col",t),localStorage.setItem("realpress_archive_property_layout_active",JSON.stringify(t))}}))};document.addEventListener("DOMContentLoaded",(e=>{p(),(()=>{if(d=document.querySelector(".realpress-archive-property-content"),!d)return;if(u=d.querySelectorAll(".realpress-item-switch-view li"),!u)return;y=d.querySelector(".realpress-property-container");let e=JSON.parse(localStorage.getItem("realpress_archive_property_layout_active"));null==e?(e=u[0].getAttribute("data-grid-col"),u[0].classList.add("active"),localStorage.setItem("realpress_archive_property_layout_active",JSON.stringify(e))):(d.querySelector('.realpress-item-switch-view li[data-grid-col="'+e+'"]').classList.add("active"),y.setAttribute("data-grid-col",e)),h()})()}))})();