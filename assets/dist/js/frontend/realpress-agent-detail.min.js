(()=>{"use strict";const e=document.querySelector(".realpress-agent-detail-property-comment"),t=e.querySelector(".realpress-agent-detail-property-comment-control").querySelectorAll("li"),a=e.querySelector(".realpress-agent-detail-property-comment-content"),r=a.querySelectorAll(":scope >div");let s;const n=REALPRESS_AGENT_DETAIL_OBJECT.user_id||"",c=()=>{for(let e=0;e<t.length;e++)t[e].addEventListener("click",(function(){const e=this;for(let r=0;r<t.length;r++){const c=t[r];if(e===c){if(!c.classList.contains("active")){const e=c.getAttribute("data-control");c.classList.add("active"),a.querySelector("div[data-content="+e+"]").classList.add("active"),s[n]=e,localStorage.setItem("realpress_agent_detail_property_comment_active",JSON.stringify(s))}}else if(c.classList.contains("active")){c.classList.remove("active");const e=c.getAttribute("data-control");a.querySelector('div[data-content="'+e+'"]').classList.remove("active")}}}))},o=()=>{if(e&&n){if(document.querySelector(".realpress-agent-detail-comment-scroll a").addEventListener("click",(function(){const t=this.getAttribute("href");e.querySelector(t).click()})),s=JSON.parse(localStorage.getItem("realpress_agent_detail_property_comment_active")),null==s&&(s={}),s[n])for(let e=0;e<t.length;e++){const r=t[e],c=r.getAttribute("data-control");c===s[n]?r.classList.contains("active")||(r.classList.add("active"),a.querySelector("div[data-content="+s[n]+"]").classList.add("active")):r.classList.contains("active")&&(r.classList.remove("active"),a.querySelector('div[data-content="'+c+'"]').classList.remove("active"))}else t[0].classList.add("active"),r[0].classList.add("active"),s[n]=t[0].getAttribute("data-control"),localStorage.setItem("realpress_agent_detail_property_comment_active",JSON.stringify(s));c()}},l=window.wp.url,i=document.querySelector(".realpress-agent-detail-property-comment");let d,p,u,m,g;const y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=d.querySelector(".realpress-agent-detail-property-container"),a=d.querySelector(".realpress-agent-detail-property-pagination-wrapper");t.style.opacity=.4,wp.apiFetch({path:(0,l.addQueryArgs)("/"+u+"/property-list",e),method:"GET"}).then((r=>{void 0!==r.data.content&&(t.innerHTML=r.data.content),void 0!==r.data.pagination?a.innerHTML=r.data.pagination:a.innerHTML="";const s=a.querySelector(".realpress-pagination");if(s){const t=s.querySelectorAll("a");for(let a=0;a<t.length;a++)t[a].addEventListener("click",(function(t){t.preventDefault();const a=this.getAttribute("data-page");y({...e,offset:a}),d.scrollIntoView({behavior:"smooth"})}))}})).catch((e=>{console.log(e)})).finally((()=>{t.style.opacity=1}))},S=()=>{i&&(d=i.querySelector(".realpress-agent-detail-property-comment-content"),p=d.querySelector(".realpress-agent-detail-property-count-sort-group .realpress-sort-by"),u=REALPRESS_GLOBAL_OBJECT.rest_namespace||"",m=REALPRESS_AGENT_DETAIL_OBJECT.user_id||"",g={author:m,posts_per_page:6,offset:1,orderby:"date",order:"DESC",template:"agent_detail"},p&&(y(g),p.addEventListener("change",(function(e){const t=d.querySelector(".realpress-pagination");let a=1;t&&(a=t.querySelector("li.current a").getAttribute("data-page"));const r=(e=>{let t,a;switch(e){case"default":default:t="date",a="DESC";break;case"name_asc":t="title",a="ASC";break;case"name_desc":t="title",a="DESC";break;case"price_desc":t="price",a="DESC";break;case"price_asc":t="price",a="ASC";break;case"rating_desc":t="rating",a="DESC";break;case"rating_asc":t="rating",a="ASC"}return{orderby:t,order:a}})(e.target.value);g={...g,...r,offset:a},y(g)}))))},f=document.querySelector(".realpress-agent-detail-property-comment-content"),L=f.querySelector(".realpress-agent-detail-comment-content");let v,_,h,E,q,A,b;const T=()=>{L.querySelector("#realpress-submit-comment").addEventListener("click",(function(e){e.preventDefault(),this.disabled=!0;const t=L.querySelector(".realpress-form-message"),a={content:L.querySelector("#realpress-comment-content").value,type:"agent",user_id:q};wp.apiFetch({path:"/"+A+"/comments",method:"POST",data:a}).then((e=>{e.msg&&(t.classList.remove("failed"),t.classList.add("success"),t.innerHTML=e.msg)})).catch((e=>{e.msg&&(t.classList.remove("success"),t.classList.add("failed"),t.innerHTML=e.msg)})).finally((()=>{this.disabled=!1,f.scrollIntoView({behavior:"smooth"})}))}))},k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v&&(v.style.opacity=.4,wp.apiFetch({path:(0,l.addQueryArgs)("/"+A+"/comments",e),method:"GET"}).then((t=>{if(t.data.content&&(v.innerHTML=t.data.content),t.data.pagination&&(_.innerHTML=t.data.pagination),h=_.querySelector(".realpress-pagination"),h){const t=h.querySelectorAll("a");for(let a=0;a<t.length;a++)t[a].addEventListener("click",(function(t){t.preventDefault();const a=this.getAttribute("data-page");k({...e,offset:a}),L.scrollIntoView({behavior:"smooth"})}))}})).catch((e=>{e.msg&&console.log(e.msg)})).finally((()=>{v.style.opacity=1})))};document.addEventListener("DOMContentLoaded",(e=>{o(),S(),L&&(v=L.querySelector(".realpress-comments-container"),_=L.querySelector(".realpress-comment-pagination-wrap"),E=L.querySelector("form"),q=REALPRESS_AGENT_DETAIL_OBJECT.user_id||"",A=REALPRESS_GLOBAL_OBJECT.rest_namespace||"",b={offset:1,orderby:"date",order:"DESC",user_id:q,type:"agent",posts_per_page:6},k(b),E&&T()),(()=>{const e=document.querySelector(".realpress-agent-detail-contact button"),t=document.querySelector(".realpress-agent-contact-form");e&&t&&(e.addEventListener("click",(function(){t.style.display="block"})),t.querySelector(".realpress-agent-contact-form-close").addEventListener("click",(function(){t.style.display="none"})),document.addEventListener("click",(function(e){e.target===t&&(t.style.display="none")})),(e=>{if(!e)return;const t=e.querySelector("button.realpress-send-message"),a=REALPRESS_GLOBAL_OBJECT.rest_namespace||"";t.addEventListener("click",(function(){t.disabled=!0,t.insertAdjacentHTML("afterbegin",' <i class="fa fa-spinner fa-spin"></i> ');const r=e.querySelector('input[name="email-target"]').value||"",s=e.querySelector('input[name="name"]').value||"",n=e.querySelector('input[name="phone"]').value||"",c=e.querySelector('input[name="email"]').value||"",o=e.querySelector(' textarea[name="message"]').value||"";let l;const i=e.querySelector('input[name="terms_and_conditions"]');l=!i||i.checked||!1;const d={email_target:r,name:s,phone:n,email:c,message:o,terms_and_conditions:l},p=e.querySelector(".realpress-message-result");wp.apiFetch({path:"/"+a+"/contact-form",method:"POST",data:d}).then((e=>{e.msg&&(p.classList.remove("failed"),p.classList.add("success"),p.innerHTML=e.msg)})).catch((e=>{e.msg&&(p.classList.remove("success"),p.classList.add("failed"),p.innerHTML=e.msg)})).finally((()=>{t.disabled=!1,t.querySelector("i.fa-spinner").remove()}))}))})(t.querySelector("form.realpress-contact-form")))})(),(()=>{const e=document.querySelector(".realpress-agent-search");if(!e)return;const t=REALPRESS_GLOBAL_OBJECT.agent_list_page_url||"";t&&e.querySelector("button").addEventListener("click",(function(){const a=e.querySelectorAll("input,select");if(!a)return;const r={offset:1,orderby:"display_name",order:"ASC"};for(let e=0;e<a.length;e++){const t=a[e],s=t.getAttribute("name");""===t.value?r.hasOwnProperty(s)&&delete r[s]:r[s]=t.value}document.location.href=(0,l.addQueryArgs)(t,r)}))})()}))})();